$ gdb ./run

(gdb) set disassembly-flavor intel
(gdb) b *start_level
(gdb) run < input.txt
(gdb) disassemble
Dump of assembler code for function start_level:              
=> 0x0000000000400605 <+0>:     push   rbp                    
   0x0000000000400606 <+1>:     mov    rbp,rsp                
   0x0000000000400609 <+4>:     sub    rsp,0x50               
   0x000000000040060d <+8>:     lea    rax,[rbp-0x50]         
   0x0000000000400611 <+12>:    mov    rdi,rax                
   0x0000000000400614 <+15>:    call   0x4004d0 <gets@plt>    
   0x0000000000400619 <+20>:    mov    rax,QWORD PTR [rbp+0x8]
   0x000000000040061d <+24>:    mov    QWORD PTR [rbp-0x8],rax
   0x0000000000400621 <+28>:    mov    rax,QWORD PTR [rbp-0x8]
   0x0000000000400625 <+32>:    mov    rsi,rax                
   0x0000000000400628 <+35>:    mov    edi,0x400733           
   0x000000000040062d <+40>:    mov    eax,0x0                
   0x0000000000400632 <+45>:    call   0x4004b0 <printf@plt>  
   0x0000000000400637 <+50>:    leave                         
   0x0000000000400638 <+51>:    ret                           
End of assembler dump.

(gdb) info registers                                                                                                   
rbp            0x7fffffffe1e0   0x7fffffffe1e0                                                                         
rsp            0x7fffffffe1c8   0x7fffffffe1c8                                                                         

 (gdb) disassemble  main                                                                                                
Dump of assembler code for function main:                                                                              
   0x0000000000400639 <+0>:     push   rbp                                                                             
   0x000000000040063a <+1>:     mov    rbp,rsp                                                                         
   0x000000000040063d <+4>:     sub    rsp,0x10                                                                        
   0x0000000000400641 <+8>:     mov    DWORD PTR [rbp-0x4],edi                                                         
   0x0000000000400644 <+11>:    mov    QWORD PTR [rbp-0x10],rsi                                                        
   0x0000000000400648 <+15>:    mov    edi,0x400750                                                                    
   0x000000000040064d <+20>:    call   0x4004a0 <puts@plt>                                                             
   0x0000000000400652 <+25>:    mov    eax,0x0                                                                         
   0x0000000000400657 <+30>:    call   0x400605 <start_level>                                                          
   0x000000000040065c <+35>:    leave                                                                                  
   0x000000000040065d <+36>:    ret                                                                                    
End of assembler dump.

# After call start_level it should return to 0x000000000040065c

# get the last stack item.
(gdb) x/1wx  0x7fffffffe1c8
0x7fffffffe1c8: 0x0040065c 

# so we need to replace this value with another function address

(gdb) c 
(gdb) disassemble                                                                                                      
Dump of assembler code for function start_level:                                                                       
   0x0000000000400605 <+0>:     push   rbp                                                                             
   0x0000000000400606 <+1>:     mov    rbp,rsp                                                                         
   0x0000000000400609 <+4>:     sub    rsp,0x50                                                                        
   0x000000000040060d <+8>:     lea    rax,[rbp-0x50]                                                                  
   0x0000000000400611 <+12>:    mov    rdi,rax                                                                         
   0x0000000000400614 <+15>:    call   0x4004d0 <gets@plt>                                                             
=> 0x0000000000400619 <+20>:    mov    rax,QWORD PTR [rbp+0x8]                                                         
   0x000000000040061d <+24>:    mov    QWORD PTR [rbp-0x8],rax                                                         
   0x0000000000400621 <+28>:    mov    rax,QWORD PTR [rbp-0x8]                                                         
   0x0000000000400625 <+32>:    mov    rsi,rax                                                                         
   0x0000000000400628 <+35>:    mov    edi,0x400733                                                                    
   0x000000000040062d <+40>:    mov    eax,0x0                                                                         
   0x0000000000400632 <+45>:    call   0x4004b0 <printf@plt>                                                           
   0x0000000000400637 <+50>:    leave                                                                                  
   0x0000000000400638 <+51>:    ret                                                                                    
End of assembler dump.  

# address of buffer 0x7fffffffe170



(gdb) x/64wx 0x7fffffffe170
0x7fffffffe170: 0x41414141      0x41414141      0x41414141      0x41414141 
0x7fffffffe180: 0x41414141      0x41414141      0x41414141      0x41414141 
0x7fffffffe190: 0x41414141      0x41414141      0x41414141      0x41414141 
0x7fffffffe1a0: 0x41414141      0x41414141      0x41414141      0x00004141 
0x7fffffffe1b0: 0xffffe1e0      0x00007fff      0x00400500      0x00000000 
0x7fffffffe1c0: 0xffffe1e0      0x00007fff      0x0040065c      0x00000000

# 0x7fffffffe1c8 is still old one. need more add values





------

main:
rbp            0x7fffffffe1e0   0x7fffffffe1e0
rsp            0x7fffffffe1d0   0x7fffffffe1d0

(gdb) x/64wx 0x7fffffffe1d0                                               
0x7fffffffe1d0: 0xffffe2c8      0x00007fff      0x00000000      0x00000001
0x7fffffffe1e0: 0x00000000      0x00000000      0xf7a303d5      0x00007fff
0x7fffffffe1f0: 0x00000000      0x00000020      0xffffe2c8      0x00007fff
0x7fffffffe200: 0x00000000      0x00000001      0x00400639      0x00000000
0x7fffffffe210: 0x00000000      0x00000000      0x5a45f860      0x9303e1f9
0x7fffffffe220: 0x00400500      0x00000000      0xffffe2c0      0x00007fff
0x7fffffffe230: 0x00000000      0x00000000      0x00000000      0x00000000
0x7fffffffe240: 0x99a5f860      0x6cfc1e06      0x5d5ff860      0x6cfc0ebf
0x7fffffffe250: 0x00000000      0x00000000      0x00000000      0x00000000
0x7fffffffe260: 0x00000000      0x00000000      0x00000000      0x00000000
0x7fffffffe270: 0x00000000      0x00000000      0x00000000      0x00000000
0x7fffffffe280: 0x00000000      0x00000000      0x00000000      0x00000000
0x7fffffffe290: 0x00400500      0x00000000      0xffffe2c0      0x00007fff
0x7fffffffe2a0: 0x00000000      0x00000000      0x00400529      0x00000000
0x7fffffffe2b0: 0xffffe2b8      0x00007fff      0x0000001c      0x00000000
0x7fffffffe2c0: 0x00000001      0x00000000      0xffffe56d      0x00007fff

(gdb) si                                                      
0x0000000000400605 in start_level ()

(gdb) disassemble                                             
Dump of assembler code for function start_level:              
=> 0x0000000000400605 <+0>:     push   rbp                    
   0x0000000000400606 <+1>:     mov    rbp,rsp                
   0x0000000000400609 <+4>:     sub    rsp,0x50               
   0x000000000040060d <+8>:     lea    rax,[rbp-0x50]         
   0x0000000000400611 <+12>:    mov    rdi,rax                
   0x0000000000400614 <+15>:    call   0x4004d0 <gets@plt>    
   0x0000000000400619 <+20>:    mov    rax,QWORD PTR [rbp+0x8]
   0x000000000040061d <+24>:    mov    QWORD PTR [rbp-0x8],rax
   0x0000000000400621 <+28>:    mov    rax,QWORD PTR [rbp-0x8]
   0x0000000000400625 <+32>:    mov    rsi,rax                
   0x0000000000400628 <+35>:    mov    edi,0x400733           
   0x000000000040062d <+40>:    mov    eax,0x0                
   0x0000000000400632 <+45>:    call   0x4004b0 <printf@plt>  
   0x0000000000400637 <+50>:    leave                         
   0x0000000000400638 <+51>:    ret                           
End of assembler dump. 

(gdb) info registers
rbp            0x7fffffffe1e0   0x7fffffffe1e0
rsp            0x7fffffffe1c8   0x7fffffffe1c8

(gdb) x/1wx 0x7fffffffe1c8 
0x7fffffffe1c8: 0x0040065c   <+====

(gdb) info registers
rbp            0x7fffffffe1c0   0x7fffffffe1c0
rsp            0x7fffffffe1c0   0x7fffffffe1c0 

rbp            0x7fffffffe1c0   0x7fffffffe1c0
rsp            0x7fffffffe170   0x7fffffffe170
